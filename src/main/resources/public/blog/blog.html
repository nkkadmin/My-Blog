<html>
    <head>
        <title>技术博客详情</title>
        <meta charset="UTF-8">
        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
        <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
        <link rel="stylesheet" href="../css/base.css">
        <style>

            .el-container:nth-child(5) .el-aside,
            .el-container:nth-child(6) .el-aside {
                line-height: 260px;
            }

            .el-container:nth-child(7) .el-aside {
                line-height: 320px;
            }
            .el-carousel__item h3 {
                color: #475669;
                font-size: 18px;
                opacity: 0.75;
                line-height: 300px;
                margin: 0;
                background-color: #475669;
            }

            .title {
                font-size: 34px;
                font-weight: 700;
                line-height: 1.3;
                text-align: center;
                margin-top: 80px;
                color: rgba(110, 125, 162, 1);
            }

            .content {
                color: rgba(110, 125, 162, 1);
            }

            .dt_other{
                text-align: right;
                margin: 20px 200px 0px 0px;
                font-size: 12px;
                color: #aedadd;
            }
            .dt_other span {
                color: rgba(110, 125, 162, .6);
            }
            .dt_other > span {
                margin-right: 5px;
            }
            .blog_item_icon {
                display: inline-block;

            }
            .blog_item_icon  .icon {
                margin-right: 0;
            }
            .blog_item_icon span {
                margin-right: 8px;
            }

            .el-card__header {
                color: rgba(110, 125, 162, 1);
            }
            .comment_content{
                font-size: 12px;
                margin-top: 10px;
                color: rgba(110, 125, 162, .5);
            }
            .floor {
                margin-right: 10px;
                color: #aedadd;
            }
            .comment-specific {
                padding-left: 26px;
                color: #6e7da2;
            }
            .load-tips {
                margin-top: 50px;
                font-size: 12px;
                text-align: center;
                color: rgba(174, 218, 221, .8);
            }

            .dianzan img{
                width: 50px;
                margin-left: 200px;
                margin-top: -40px;
                margin-bottom: 20px;
                cursor: pointer;
            }



            .common-input textarea {
                outline: none;
                background: transparent;
                border: 1px solid #EBEEF5;
            }
            .common-input textarea:hover,
            .common-input textarea:focus {
                border-color: #db996c;
            }
            .el-button--primary {
                color: #6e7da2;
                background-color: transparent;
                border-color: #EBEEF5;
            }
            .el-button--primary:hover,
            .el-button--primary:active,
            .el-button--primary:focus {
                background-color: #db996c;
                border-color: #db996c;
            }

            .el-card {
                border: 1px solid #EBEEF5;
                background-color: rgba(174, 218, 221, .05);
                color: #303133;
            }


            .heart {
                width: 100px;
                height: 100px;
                background: url("https://cssanimation.rocks/images/posts/steps/heart.png") no-repeat;
                background-position: 0 0;
                cursor: pointer;
                -webkit-transition: background-position 1s steps(28);
                transition: background-position 1s steps(28);
                -webkit-transition-duration: 0s;
                transition-duration: 0s;
            }
            .heart.is-active {
                -webkit-transition-duration: 1s;
                transition-duration: 1s;
                background-position: -2800px 0;
            }
        </style>
    </head>
    <body>
   <!-- <embed src="../muics/chai.mp3" hidden="true"/>-->
    <div id="app">
            <template>
                <header-content></header-content>
                <el-container>

                    <el-main>
                        <el-row>
                            <el-col :span="24">
                                <div class="grid-content bg-purple-dark title" v-text="info.title">
                                </div>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="24">
                                <div class="grid-content bg-purple-dark dt_other">
                                    <span>{{info.createTime}}</span>|

                                    <div class="blog_item_icon">
                                        <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16715"><path d="M512 133.338844c-215.438701 0-407.359778 148.474566-489.868957 378.661156 82.508155 230.185566 274.430256 378.661156 489.868957 378.661156s407.359778-148.47559 489.868957-378.661156C919.359778 281.812387 727.437677 133.338844 512 133.338844zM512 836.452533c-186.740078 0-359.12931-125.555577-439.446567-319.869145l-1.793856-4.583388 1.793856-4.584412c80.316234-194.312544 252.706489-319.869145 439.446567-319.869145 186.540534 0 359.130334 125.555577 439.248046 319.869145l1.992377 4.584412-1.992377 4.583388C871.130334 710.895933 698.53951 836.452533 512 836.452533zM512 343.992565c-93.070722 0-168.802544 75.732845-168.802544 169.003112 0 93.070722 75.731822 168.802544 168.802544 168.802544s168.803567-75.731822 168.803567-168.802544C680.803567 419.726433 605.070722 343.992565 512 343.992565zM512 637.953643c-68.955488 0-124.956943-56.199976-124.956943-124.956943 0-68.956511 56.002478-124.95899 124.956943-124.95899 68.756967 0 124.95899 56.001455 124.95899 124.95899C636.957966 581.753667 580.756967 637.953643 512 637.953643z" p-id="16716"></path></svg>
                                        <span>{{info.lookNum == null ? 0 : info.lookNum}}</span>
                                        <svg class="icon" style="width: 16px; height: 16px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12433"><path d="M755.2 389.12c-33.28 0-61.44 28.16-61.44 61.44 0 33.28 28.16 61.44 61.44 61.44 33.28 0 61.44-28.16 61.44-61.44C816.64 417.28 788.48 389.12 755.2 389.12L755.2 389.12 755.2 389.12zM512 816.64c-35.84 0-69.12-5.12-102.4-10.24l-143.36 87.04 2.56-140.8c-110.08-66.56-181.76-174.08-181.76-299.52C87.04 250.88 276.48 87.04 512 87.04c235.52 0 424.96 163.84 424.96 363.52C936.96 652.8 747.52 816.64 512 816.64L512 816.64 512 816.64zM512 25.6C243.2 25.6 25.6 215.04 25.6 450.56c0 133.12 71.68 253.44 181.76 332.8L207.36 998.4l212.48-130.56c30.72 5.12 58.88 7.68 92.16 7.68 268.8 0 486.4-189.44 486.4-424.96C998.4 215.04 780.8 25.6 512 25.6L512 25.6 512 25.6zM268.8 389.12c-33.28 0-61.44 28.16-61.44 61.44 0 33.28 28.16 61.44 61.44 61.44 33.28 0 61.44-28.16 61.44-61.44C330.24 417.28 302.08 389.12 268.8 389.12L268.8 389.12 268.8 389.12zM512 389.12c-33.28 0-61.44 28.16-61.44 61.44 0 33.28 28.16 61.44 61.44 61.44 33.28 0 61.44-28.16 61.44-61.44C573.44 417.28 545.28 389.12 512 389.12L512 389.12 512 389.12zM512 389.12" p-id="12434"></path></svg>
                                        <span>{{info.commentNum == null ? 0 : info.commentNum}}</span>
                                        <svg class="icon" style="width: 16px; height: 16px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1035 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14600"><path d="M676.928307 372.09153l235.957013 0c33.059953 0 63.695694 20.154016 84.021625 47.140647 20.595061 27.353998 27.329439 65.360614 17.998933 97.80863L897.701502 922.509515c-12.734022 46.774303-55.124482 75.846432-102.976326 75.846432L122.774231 998.355947c-58.871829 0-119.181403-37.917588-119.181403-96.788393L3.592828 520.397251c0-60.683081 62.318324-123.745349 119.181403-123.745349l107.212814 0c135.350664 0 224.883817-94.108355 224.883817-231.906767L454.870862 136.65538c0-56.643068 63.913659-115.556852 122.466216-115.556852l2.865257 0c44.839231 0 86.053911 34.343179 100.257401 76.92909l7.150864 22.093181c21.354354 64.11218 22.796192 154.603147 8.391111 203.419969M645.689838 311.601854c13.787004-55.1736 11.895935-118.29215-6.250354-172.754552l-6.757914-24.399713c-7.54279-22.602787-29.288047-43.207058-52.479235-43.207058l-2.865257 0c-30.733978 0-72.324212 36.543288-72.324212 65.414849l0 28.088732c0 166.401868-111.072725 282.048771-275.02582 282.048771L122.774231 446.792882c-29.607318 0-69.039399 40.225143-69.039399 73.603345L53.734832 901.56653c0 31.198559 37.84084 46.64639 69.039399 46.64639l671.951969 0c24.880667 0 47.89994-13.123902 54.683437-38.029128l117.30159-407.139767c5.069459-17.656125 1.469468-39.830147-9.868765-54.891168-10.775414-14.301727-26.79118-25.920346-43.957141-25.920346L605.296873 422.23251l0-40.932248M229.231845 983.237621c-13.860682 0-25.071002-11.216459-25.071002-25.077142L204.160843 456.627878c0-13.860682 11.210319-25.077142 25.071002-25.077142s25.071002 11.215436 25.071002 25.077142l0 501.533624C254.302847 972.021162 243.092527 983.237621 229.231845 983.237621z" p-id="14601"></path></svg>
                                        <span>{{info.zanNum == null ? 0 : info.zanNum}}</span>
                                    </div>
                                </div>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="24">
                                <div class="grid-content bg-purple-dark content" v-html="info.content">
                                </div>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col>
                                <div @click="dianzan" :class="{'is-active': like}" class="heart"></div>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-form ref="form" :model="form">
                                <el-form-item label="">
                                    <el-input type="textarea" placeholder="写下您的评论" v-model="form.commonDesc" class="common-input"></el-input>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="onSubmit">评论</el-button>
                                </el-form-item>
                            </el-form>
                        </el-row>
                        <el-row :gutter="24" >
                            <el-col :span="24" class="comment">
                                <el-card shadow="never" class="comment_card">
                                <div slot="header" class="clearfix" style="display: none;">
                                    <span>评论</span>
                                </div>
                                <div class="grid-content bg-purple">
                                    <div v-for="(item,index) in commentList" :key="item.id" class="text item comment_content">
                                        <span class="floor">
                                            #{{index+1}}
                                        </span> {{item.createTime}}<br/>
                                        <p class="comment-specific">
                                            {{item.content}}
                                        </p>
                                    </div>
                                </div>
                                <div v-if="commentList.length == 0" style="color: #aedadd;">暂无评论</div>
                                <div v-if="commentList.length > 0 && commentForm.pageNo < commentForm.totalPage" @click="more" class="load-tips">加载更多</div>
                                <div v-if="commentList.length > 0 &&commentForm.pageNo >= commentForm.totalPage" class="load-tips">已全部加载</div>
                                </el-card>
                             </el-col>
                        </el-row>
                    </el-main>
                </el-container>
                <top></top>
                <footer-content></footer-content>
            </template>
        </div>
    </body>
    <script type="text/javascript" src="../js/vue.js"></script>
    <script type="text/javascript" src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/url.js"></script>
    <script src="../js/index/component.js"></script>
<script>
    var Main = {
            methods: {
                dianzan:function(){
                    var self = this;
                    axios.get("/index/blog/dianZan/"+self.id,null).then(function(response){
                        if(response.data > -1 ){
                            self.$message({
                                showClose: true,
                                message: '点赞成功',
                                type: 'success'
                            });
                        }
                        self.like = true
                    });
                },
                getInfo:function(){
                    var self = this;
                    self.tableData = [];
                    self.isAppend = false;
                    axios.get("/index/blog/info/"+self.id,null).then(function(response){
                        if(response.data != null && response.data != null){
                            self.info = response.data;
                            $("title").text(self.info.title);
                        }
                        self.loadComment();
                    });
                },
                addLookNum:function(){ //添加浏览量
                    axios.get("/index/blog/look/"+this.id,null).then(function(response){
                        if(response.data != null && response.data != null){

                        }
                    });
                },
                initParam:function(){
                    var param = GetRequest();
                    this.id = param.id;
                    this.commentForm.blogId = param.id;
                },
                onSubmit:function(){
                    var self = this;
                    if(self.form.commonDesc == null || self.form.commonDesc === ""){
                        this.$message({
                            showClose: true,
                            message: '请填写评论内容',
                            type: 'warning'
                        });
                        return;
                    }
                    var params={
                        blogId:self.id,
                        content:self.form.commonDesc
                    }
                    axios.post("/index/comment/save",params).then(function(response){
                        self.$message({
                            showClose: true,
                            message: response.data.success ? "评论成功" : "评论失败",
                            type: response.data.success ? "success" : "error"
                        });
                        if(response.data.success){
                            self.form.commonDesc = null;
                            self.appendComent = false;
                            self.loadComment();
                        }
                    });
                },
                loadComment:function(){
                    var self = this;
                    if(!self.appendComent){
                        self.commentList.splice(0,self.commentList.length);
                        self.appendComent = true;
                    }

                    axios.post("/index/comment/getComment",this.commentForm).then(function(response){
                        if(response.data != null){
                            var contentList = response.data.list;
                            for(var index in contentList){
                                self.commentList.push(contentList[index]);
                            }
                            self.commentForm.totalPage = response.data.pages;
                        }
                    });
                },
                more:function(){
                    if(this.commentForm.totalPage > this.commentForm.pageNo){
                        this.commentForm.pageNo = this.commentForm.pageNo + 1;
                        this.loadComment();
                    }
                }
            },
            data() {
                return {
                    id:"",
                    info:"",
                    form:{
                        commonDesc:null
                    },
                    commentForm:{
                      blogId:"",
                      pageNo:1,
                      pageSize:10,
                      totalPage:0
                    },
                    commentList:[],
                    appendComent:true,
                    like: false
                }
            },
            mounted:function(){
                this.initParam();
                this.getInfo();
                this.addLookNum();
            }
        }
        var Ctor = Vue.extend(Main)
        new Ctor().$mount('#app')
    </script>
</html>