<html>
    <head>
        <title>HOME</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
        <style>
            .el-header, .el-footer {
                background-color: #B3C0D1;
                color: #333;
                text-align: center;
                line-height: 60px;
            }
            .el-header{
                padding: 0px !important;
            }
            .el-aside {
                background-color: #D3DCE6;
                color: #333;
                text-align: center;
                line-height: 200px;
            }


            body > .el-container {
                margin-bottom: 40px;
            }

            .el-container:nth-child(5) .el-aside,
            .el-container:nth-child(6) .el-aside {
                line-height: 260px;
            }

            .el-container:nth-child(7) .el-aside {
                line-height: 320px;
            }
            .el-carousel__item h3 {
                color: #475669;
                font-size: 18px;
                opacity: 0.75;
                line-height: 300px;
                margin: 0;
                background-color: #475669;
            }

            .text {
                font-size: 14px;
            }
            .left_content .right_content{
                background-color: #fdfdfd;
                min-height: 500px;
            }

            .blog_item{
                margin-bottom: 20px;
            }
            .blog_item_img{
                max-width: 100%;
                height: auto;
                border-radius: 5px;
            }
            .load_more{
                width: 400px;
                margin: 50px 0px 50px 300px;
            }
        </style>
    </head>
    <body>
   <!-- <embed src="../muics/chai.mp3" hidden="true"/>-->
    <div id="app">
            <template>
                <el-container>
                    <el-header>
                        <el-menu
                                :default-active="defaultIndex"
                                class="el-menu-demo x_right"
                                mode="horizontal"
                                @select="handleSelect"
                                background-color="#545c64"
                                text-color="#fff"
                                active-text-color="#ffd04b">
                            <el-menu-item :class="'menuItem'+index" v-for="(item,index) in menuList" :index="''+index" :menu-id="item.id" >{{item.name}}</el-menu-item>
                            <el-menu-item style="float: right;margin-right: 100px;">博客名称</el-menu-item>
                        </el-menu>

                    </el-header>
                    <el-main>
                        <el-carousel indicator-position="outside">
                            <el-carousel-item v-for="item in 4" :key="item">
                                <h3>{{ item }}</h3>
                            </el-carousel-item>
                        </el-carousel>
                        <el-row :gutter="20">
                            <el-col :span="16" class="left_content">
                                <el-row class="blog_item" :gutter="20" v-for="item in blogList" :key="item.id">
                                    <el-col :span="4">
                                        <div class="grid-content bg-purple">
                                            <img class="blog_item_img" src="https://element.faas.ele.me/static/hamburger.50e4091.png"/>
                                        </div>
                                    </el-col>
                                    <el-col :span="20">
                                        <div class="grid-content bg-purple">
                                            <div height="10px">标题：{{item.title}}</div>
                                            <div>发布日期：{{item.createTime}}</div>
                                            <div>内容：{{item.content}}</div>
                                        </div>
                                    </el-col>
                                </el-row>
                                <el-button @click="loadMoreFun" v-loading.fullscreen.lock="fullscreenLoading" class="load_more" type="warning" round>加载更多</el-button>
                            </el-col>
                            <el-col :span="8" class="right_content">

                            </el-col>
                        </el-row>
                    </el-main>
                    <el-footer>footer</el-footer>
                </el-container>
            </template>
        </div>
    </body>
    <script type="text/javascript" src="../js/vue.js"></script>
    <script type="text/javascript" src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
<script>
    var Main = {
            methods: {
                loadData(){
                    var self = this;
                    self.tableData = [];

                    axios.post("/blog/index",null).then(function(response){
                        console.log(response);
                        if(response.data != null && response.data.menu != null){
                            self.menuList = response.data.menu;
                        }
                        if(self.menuList.length > 0){
                            //获取第一个菜单
                            var menuId = self.menuList[0].id;
                            self.currentMenuId = menuId;
                            self.getBlogByMenuId(menuId);
                        }
                    });
                },
                getBlogByMenuId:function(menuId){
                    var self = this;
                    axios.post("/blog/getBlog",{"pageNo":self.page.pageNo,"pageSize":self.page.pageSize,"selectMenu":menuId}).then(function(response){
                        console.log(response);
                        if(response.data != null && response.data.object != null){
                            self.blogList = response.data.object.content;
                            self.totalPage = response.data.object.totalPages;
                            self.totalSize = response.data.object.totalElements;
                        }
                        self.fullscreenLoading = false;
                    });
                },
                handleSelect(key, keyPath) {
                    var menuId = $(".menuItem"+key).attr("menu-id");
                    this.currentMenuId = menuId;
                    this.getBlogByMenuId(menuId);
                },
                loadMoreFun() {
                    this.fullscreenLoading = true;
                    if(this.page.pageNo < this.page.totalPage){
                        this.page.pageNo += 1;
                        //获取当前选中的菜单
                        this.getBlogByMenuId(this.currentMenuId);
                    }

                }
            },
            data() {
                return {
                    currentMenuId:'',
                    defaultIndex:'0',
                    currentDate: new Date(),
                    menuList:[],
                    blogList:[],
                    searchKey:'', //搜索关键字
                    fullscreenLoading: false,
                    page:{
                        pageNo:1,
                        pageSize:5,
                        totalPage:1,//共几页
                        totalSize:0 //共几条记录
                    }
                }
            },
            mounted:function(){
                this.loadData();
            }
        }
        var Ctor = Vue.extend(Main)
        new Ctor().$mount('#app')
    </script>
</html>