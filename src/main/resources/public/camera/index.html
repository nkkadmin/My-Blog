<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>摄影作品</title>
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/timelinr/jquery.timelinr-2.0.0.js"></script>
    <script type="text/javascript" src="../js/timelinr/jquery.mousewheel.js"></script>

    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.css"/>
    <link rel="stylesheet" href="../css/timelinr/course.css"/>
    <!--<link rel="stylesheet" href="../css/timelinr/main.css"/>-->
</head>
<body>
<div id="app">
    <template>
        <header-content></header-content>
        <el-container>
            <el-main>
                <div id="main">
                    <div id="timeline" class="timeline">
                        <button id="prev" class="prev">
                            <i class=""><img src="../img/timelinr/icon_time_arrow_left.png" alt=""/></i>
                        </button>
                        <button id="next" class="next">
                            <i class=""><img src="../img/timelinr/icon_time_arrow_right.png" alt=""/></i>
                        </button>
                        <ul id="dates" class="dates">
                            <li v-for="value in years" :key="value">
                                <a @click="clickYear(value)" :href="'#'+value" :name="value">{{value}}</a>
                                <hr class="onepx"/>
                            </li>
                        </ul>
                        <hr class="hrLine"/>
                        <div class="wrap">
                            <ul class="issues" id="issues2">
                                <li>
                                    <item v-for="(item,index) in listData" :key="index">
                                        <!--往右-->
                                        <div v-if="index % 2 == 0" class="left"></div>
                                        <div style="cursor: pointer;" @click="info(item.coverId)" v-if="index % 2 == 0" class="right">
                                            <h5>{{item.createTime}}</h5>
                                            <hr class="yearLine"/>
                                            <span class="textArea">
                                                <img class="item_content_img" :src="item.url"/>
                                            </span>
                                        </div>
                                        <!--往左-->
                                        <div style="cursor: pointer;" @click="info(item.coverId)" v-if="index % 2 != 0" class="left">
                                            <h5>{{item.createTime}}</h5>
                                            <hr class="yearLine"/>
                                            <span class="textArea">
                                              <img class="item_content_img" :src="item.url"/>
                                            </span>
                                        </div>
                                        <div v-if="index % 2 != 0" class="right"></div>
                                    </item>
                                </li>
                            </ul>
                        </div>
                        <div v-if="hasNextPage" @click="nextPage" class="more">MORE ↓</div>
                    </div>
                </div>
            </el-main>
        </el-container>
        <footer-content></footer-content>
    </template>
</div>

</body>
<script type="text/javascript" src="../js/vue.js"></script>
<script type="text/javascript" src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="../js/index/component.js"></script>
<script>
    $(function () {
        $().timelinr({
            autoPlay: false,
            autoPlayDirection: "forward",
            startAt: 1,
            mousewheel: 'true'
        });
    })
</script>
<script>
    var Main = {
        methods: {

            loadCream:function () {
                var self = this;
                self.issuesHeight = 0;
                if(!self.isAppend)
                    self.listData = [];

                var param = {
                    "pageNo":self.pageNo,
                    "pageSize":self.pageSize,
                    "year":self.year
                }
                axios.post("/index/camrea/searchList", param).then(function (response) {
                    // self.listData = self.listData.concat(response.data.object);
                    if(self.listData.length > 0){
                        self.listData = self.listData.concat(response.data.object);
                    }else{
                        self.listData = response.data.object;
                    }
                    self.years = response.data.years;
                    var datas = self.listData;
                    var itemSize = 0;
                    for(var key in datas){
                        itemSize += datas[key].length;
                    }
                    self.issuesHeight = itemSize * 250;
                    self.pageNo = response.data.pageNo;
                    self.hasNextPage = response.data.hasNextPage;
                    $(".issues").css("height",self.issuesHeight+"px !important");
                });
            },
            info:function(id){
                window.location.href = "/blog/blog.html?id="+id;
            },
            nextPage:function () {
                this.pageNo++;
                this.isAppend = true;
                this.loadCream();
            },
            clickYear:function (year) {
                this.year = year;
                this.isAppend = false;
                this.loadCream();

            }

        },
        data() {
            return {
                issuesHeight:0, //数据条数
                pageNo:1,
                pageSize:10,
                hasNextPage:false,
                currentMenuId: '',
                menuList: [],
                listData: [],
                isAppend:false,
                years:[],
                year:null
            }
        },
        mounted: function () {
            self.isAppend = false;
            this.loadCream();
        }
    }
    var Ctor = Vue.extend(Main)
    new Ctor().$mount('#app')
</script>
</html>
